<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»Ÿè®¾ç½® - AIå§¿åŠ¿å‚è€ƒå›¾åº“</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <style>
        /* ===== å…¨å±€æ ·å¼ ===== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-gradient: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --info-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --danger-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            --secondary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --shadow-light: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-medium: 0 5px 20px rgba(0,0,0,0.15);
            --shadow-heavy: 0 10px 30px rgba(0,0,0,0.2);
            --border-radius: 15px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #2c3e50;
        }

        /* ===== å®¹å™¨å¸ƒå±€ ===== */
        .main-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            margin: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-heavy);
            min-height: calc(100vh - 40px);
        }

        /* ===== é¡µé¢å¤´éƒ¨ ===== */
        .admin-header {
            background: var(--secondary-gradient);
            color: white;
            padding: 2.5rem 2rem;
            position: relative;
            overflow: hidden;
        }

        .admin-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1.5" fill="white" opacity="0.08"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.12"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        }

        .admin-header .row {
            position: relative;
            z-index: 2;
        }

        .admin-header h1 {
            font-weight: 700;
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .admin-header p {
            opacity: 0.85;
            font-size: 1.1rem;
        }

        /* ===== æ€§èƒ½ç›‘æ§å¡ç‰‡ ===== */
        .metric-cards {
            padding: 2rem;
            margin-bottom: 1rem;
        }

        .metric-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            height: 100%;
            border: 1px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--secondary-gradient);
        }

        .metric-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.2);
        }

        .metric-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-light);
            transition: var(--transition);
        }

        .metric-card:hover .metric-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .metric-primary { background: var(--primary-gradient); }
        .metric-success { background: var(--success-gradient); }
        .metric-warning { background: var(--warning-gradient); }
        .metric-info { background: var(--info-gradient); }
        .metric-danger { background: var(--danger-gradient); }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0.5rem 0;
            background: var(--secondary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .metric-label {
            color: #6c757d;
            font-size: 0.95rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .metric-change {
            font-size: 0.8rem;
            color: #6c757d;
            background: rgba(0,0,0,0.03);
            padding: 0.3rem 0.6rem;
            border-radius: 10px;
            margin-top: 0.5rem;
        }

        /* ===== æ ‡ç­¾é¡µåŒºåŸŸ ===== */
        .tab-section {
            background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
            border-radius: 20px;
            margin: 0 2rem 2rem;
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .nav-tabs {
            border-bottom: none;
            background: var(--secondary-gradient);
            padding: 1.5rem 2rem 0;
            position: relative;
        }

        .nav-tabs::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255,255,255,0.2);
        }

        .nav-tabs .nav-link {
            border: none;
            border-radius: 12px 12px 0 0;
            margin-right: 0.5rem;
            color: rgba(255,255,255,0.7);
            font-weight: 600;
            padding: 1rem 1.5rem;
            transition: var(--transition);
            background: transparent;
            position: relative;
            overflow: hidden;
        }

        .nav-tabs .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .nav-tabs .nav-link:hover::before {
            left: 100%;
        }

        .nav-tabs .nav-link:hover {
            color: white;
            background: rgba(255,255,255,0.1);
        }

        .nav-tabs .nav-link.active {
            background: white;
            color: #667eea;
            font-weight: 700;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
        }

        .tab-content {
            padding: 2.5rem 2rem;
            background: white;
        }

        /* ===== æ“ä½œå¡ç‰‡ ===== */
        .action-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid rgba(102, 126, 234, 0.1);
            transition: var(--transition);
            text-align: center;
            height: 100%;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .action-card:hover {
            border-color: #667eea;
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.2);
        }

        .action-card:hover::before {
            transform: scaleX(1);
        }

        .action-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: var(--transition);
        }

        .action-card:hover .action-icon {
            transform: scale(1.1) rotateY(180deg);
        }

        /* ===== æ—¥å¿—å®¹å™¨ ===== */
        .log-container {
            background: linear-gradient(135deg, #1e1e1e 0%, #2c2c2c 100%);
            color: #ffffff;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.85rem;
            max-height: 500px;
            overflow-y: auto;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: var(--shadow-medium);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .log-line {
            margin-bottom: 0.3rem;
            word-wrap: break-word;
            padding: 0.2rem 0;
            border-left: 3px solid transparent;
            padding-left: 0.5rem;
        }

        .log-timestamp {
            color: #6c757d;
            font-weight: 600;
        }

        .log-level-error {
            color: #ff6b8a;
            border-left-color: #ff6b8a;
            background: rgba(255, 107, 138, 0.1);
        }

        .log-level-warning {
            color: #ffc947;
            border-left-color: #ffc947;
            background: rgba(255, 201, 71, 0.1);
        }

        .log-level-info {
            color: #4facfe;
            border-left-color: #4facfe;
            background: rgba(79, 172, 254, 0.1);
        }

        /* ===== é…ç½®åŒºåŸŸ ===== */
        .config-section {
            background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-light);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .config-section h6 {
            color: #667eea;
            font-weight: 700;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .config-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            transition: var(--transition);
        }

        .config-item:hover {
            background: rgba(102, 126, 234, 0.05);
            margin: 0 -1rem;
            padding-left: 1rem;
            padding-right: 1rem;
            border-radius: 8px;
        }

        .config-item:last-child {
            border-bottom: none;
        }

        .config-label {
            font-weight: 600;
            color: #495057;
        }

        .config-value {
            color: #6c757d;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.9rem;
            background: rgba(0,0,0,0.03);
            padding: 0.3rem 0.6rem;
            border-radius: 8px;
        }

        /* ===== çŠ¶æ€æŒ‡ç¤ºå™¨ ===== */
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .status-online { 
            background: linear-gradient(135deg, #28a745, #20c997);
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.5);
        }

        .status-warning { 
            background: linear-gradient(135deg, #ffc107, #fd7e14);
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        .status-offline { 
            background: linear-gradient(135deg, #dc3545, #c82333);
            box-shadow: 0 0 10px rgba(220, 53, 69, 0.5);
        }

        /* ===== å¤‡ä»½é¡¹ç›® ===== */
        .backup-item {
            background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--primary-gradient);
            box-shadow: var(--shadow-light);
            transition: var(--transition);
        }

        .backup-item:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-medium);
        }

        /* ===== å›¾è¡¨å®¹å™¨ ===== */
        .performance-chart {
            height: 350px;
            background: white;
            border-radius: 15px;
            padding: 1rem;
            box-shadow: var(--shadow-light);
            border: 1px solid rgba(0,0,0,0.05);
        }

        /* ===== æŒ‰é’®æ ·å¼ ===== */
        .btn {
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            position: relative;
            overflow: hidden;
            font-size: 0.95rem;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--primary-gradient);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: var(--success-gradient);
            box-shadow: 0 4px 15px rgba(86, 171, 47, 0.3);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(86, 171, 47, 0.4);
        }

        .btn-warning {
            background: var(--warning-gradient);
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);
        }

        .btn-info {
            background: var(--info-gradient);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .btn-danger {
            background: var(--danger-gradient);
            box-shadow: 0 4px 15px rgba(255, 65, 108, 0.3);
        }

        .btn-outline-primary {
            border: 2px solid #667eea;
            color: #667eea;
            background: transparent;
        }

        .btn-outline-primary:hover {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-outline-warning,
        .btn-outline-success,
        .btn-outline-info,
        .btn-outline-secondary,
        .btn-outline-danger {
            border-width: 2px;
            font-weight: 600;
        }

        /* ===== è¡¨å•æ§ä»¶ ===== */
        .form-control, .form-select {
            border-radius: 12px;
            border: 2px solid rgba(0,0,0,0.1);
            padding: 0.75rem 1rem;
            transition: var(--transition);
            background: rgba(255,255,255,0.9);
            font-size: 0.95rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
            background: white;
        }

        /* ===== è¡¨æ ¼æ ·å¼ ===== */
        .table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }

        .table thead {
            background: var(--secondary-gradient);
            color: white;
        }

        .table th {
            border: none;
            padding: 1.2rem 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.85rem;
        }

        .table td {
            border: none;
            padding: 1rem;
            vertical-align: middle;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .table tbody tr {
            transition: var(--transition);
        }

        .table tbody tr:hover {
            background: rgba(102, 126, 234, 0.05);
            transform: scale(1.01);
        }

        /* ===== è¿›åº¦æ¡æ ·å¼ ===== */
        .progress {
            border-radius: 10px;
            height: 8px;
            background: rgba(0,0,0,0.1);
        }

        .progress-bar {
            border-radius: 10px;
            transition: width 0.6s ease;
        }

        /* ===== å¾½ç« æ ·å¼ ===== */
        .badge {
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-weight: 600;
        }

        .badge.bg-success {
            background: var(--success-gradient) !important;
        }

        .badge.bg-danger {
            background: var(--danger-gradient) !important;
        }

        .badge.bg-warning {
            background: var(--warning-gradient) !important;
        }

        .badge.bg-info {
            background: var(--info-gradient) !important;
        }

        .badge.bg-primary {
            background: var(--primary-gradient) !important;
        }

        /* ===== åŠ è½½é®ç½© ===== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            display: none;
            backdrop-filter: blur(10px);
        }

        .loading-content {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: var(--shadow-heavy);
            animation: loadingPulse 2s ease-in-out infinite;
        }

        @keyframes loadingPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ===== é€šçŸ¥æ ·å¼ ===== */
        .alert {
            border-radius: var(--border-radius);
            border: none;
            padding: 1rem 1.5rem;
            font-weight: 500;
            box-shadow: var(--shadow-light);
        }

        .alert-success {
            background: linear-gradient(135deg, #d4edda, #a8e6cf);
            color: #155724;
        }

        .alert-danger {
            background: linear-gradient(135deg, #f8d7da, #fab1a0);
            color: #721c24;
        }

        .alert-info {
            background: linear-gradient(135deg, #cce7ff, #a8d8ea);
            color: #0c5460;
        }

        .alert-warning {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 768px) {
            .main-container {
                margin: 10px;
                border-radius: 20px;
            }
            
            .admin-header {
                padding: 2rem 1.5rem;
            }
            
            .admin-header h1 {
                font-size: 1.8rem;
            }
            
            .metric-cards, .tab-section {
                margin-left: 1rem;
                margin-right: 1rem;
                padding: 1.5rem;
            }
            
            .metric-card {
                padding: 1.5rem;
                margin-bottom: 1rem;
            }
            
            .metric-value {
                font-size: 2rem;
            }
            
            .tab-content {
                padding: 1.5rem;
            }
            
            .action-card {
                margin-bottom: 1rem;
            }
            
            .nav-tabs {
                padding: 1rem;
            }
            
            .nav-tabs .nav-link {
                padding: 0.8rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* ===== æ»šåŠ¨æ¡æ ·å¼ ===== */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary-gradient);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5a6fd8, #6b59cc);
        }

        /* ===== åŠ¨ç”»å¢å¼º ===== */
        .animate-fade-in {
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .animate-slide-up {
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== ç‰¹æ®Šæ•ˆæœ ===== */
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .glow-effect {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        /* ===== å·¥å…·æç¤º ===== */
        [data-tooltip] {
            position: relative;
            cursor: help;
        }

        [data-tooltip]::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        [data-tooltip]:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-5px);
        }

        /* ===== æ¸…ç†ç»“æœæ ·å¼ ===== */
        #cleanupResults {
            animation: slideUp 0.5s ease;
        }

        .cleanup-details {
            max-height: 300px;
            overflow-y: auto;
            background: rgba(0,0,0,0.03);
            border-radius: 10px;
            padding: 1rem;
        }

        /* ===== ç³»ç»ŸçŠ¶æ€å¾½ç«  ===== */
        .system-status-badge {
            background: var(--success-gradient);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            box-shadow: var(--shadow-light);
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    {% include "components/admin_nav.html" %}

    <div class="main-container animate-fade-in">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="admin-header">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1>
                        <i class="fas fa-server me-3"></i>ç³»ç»Ÿç›‘æ§ä¸­å¿ƒ
                    </h1>
                    <p class="mb-0">å®æ—¶ç›‘æ§ç³»ç»Ÿæ€§èƒ½ Â· æ™ºèƒ½ç»´æŠ¤å·¥å…· Â· é…ç½®ç®¡ç† Â· å¤‡ä»½æ¢å¤</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="d-flex align-items-center justify-content-end gap-3">
                        <span class="system-status-badge">
                            <i class="fas fa-circle status-indicator status-online"></i>
                            ç³»ç»Ÿè¿è¡Œæ­£å¸¸
                        </span>
                        <button class="btn btn-light" onclick="refreshAllData()" data-tooltip="åˆ·æ–°æ‰€æœ‰ç³»ç»Ÿæ•°æ®">
                            <i class="fas fa-sync-alt me-2"></i>åˆ·æ–°æ•°æ®
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ€§èƒ½ç›‘æ§å¡ç‰‡ -->
        <div class="metric-cards">
            <div class="row">
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="metric-card animate-slide-up">
                        <div class="metric-icon metric-primary">
                            <i class="fas fa-microchip"></i>
                        </div>
                        <div class="metric-label">CPU ä½¿ç”¨ç‡</div>
                        <h3 class="metric-value" id="cpuUsage">-</h3>
                        <div class="metric-change">
                            <i class="fas fa-processor me-1"></i>
                            <span id="cpuCores">- æ ¸å¿ƒ</span>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="metric-card animate-slide-up" style="animation-delay: 0.1s;">
                        <div class="metric-icon metric-success">
                            <i class="fas fa-memory"></i>
                        </div>
                        <div class="metric-label">å†…å­˜ä½¿ç”¨ç‡</div>
                        <h3 class="metric-value" id="memoryUsage">-</h3>
                        <div class="metric-change">
                            <i class="fas fa-microchip me-1"></i>
                            <span id="memoryDetails">- / -</span>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="metric-card animate-slide-up" style="animation-delay: 0.2s;">
                        <div class="metric-icon metric-warning">
                            <i class="fas fa-hdd"></i>
                        </div>
                        <div class="metric-label">ç£ç›˜ä½¿ç”¨ç‡</div>
                        <h3 class="metric-value" id="diskUsage">-</h3>
                        <div class="metric-change">
                            <i class="fas fa-database me-1"></i>
                            <span id="diskDetails">- / -</span>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="metric-card animate-slide-up" style="animation-delay: 0.3s;">
                        <div class="metric-icon metric-info">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="metric-label">å­˜å‚¨å¤§å°</div>
                        <h3 class="metric-value" id="dbSize">-</h3>
                        <div class="metric-change">
                            <i class="fas fa-file me-1"></i>
                            <span id="dbTables">- æ–‡ä»¶</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸»è¦åŠŸèƒ½æ ‡ç­¾é¡µ -->
        <div class="tab-section">
            <ul class="nav nav-tabs" id="systemTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="performance-tab" data-bs-toggle="tab" data-bs-target="#performance" 
                            type="button" role="tab" onclick="showPerformanceTab()">
                        <i class="fas fa-chart-line me-2"></i>æ€§èƒ½ç›‘æ§
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="maintenance-tab" data-bs-toggle="tab" data-bs-target="#maintenance" 
                            type="button" role="tab" onclick="showMaintenanceTab()">
                        <i class="fas fa-tools me-2"></i>ç³»ç»Ÿç»´æŠ¤
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="config-tab" data-bs-toggle="tab" data-bs-target="#config" 
                            type="button" role="tab" onclick="showConfigTab()">
                        <i class="fas fa-cog me-2"></i>ç³»ç»Ÿé…ç½®
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="logs-tab" data-bs-toggle="tab" data-bs-target="#logs" 
                            type="button" role="tab" onclick="showLogsTab()">
                        <i class="fas fa-file-alt me-2"></i>ç³»ç»Ÿæ—¥å¿—
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="backup-tab" data-bs-toggle="tab" data-bs-target="#backup" 
                            type="button" role="tab" onclick="showBackupTab()">
                        <i class="fas fa-archive me-2"></i>å¤‡ä»½ç®¡ç†
                    </button>
                </li>
            </ul>
            
            <div class="tab-content" id="systemTabsContent">
                <!-- æ€§èƒ½ç›‘æ§æ ‡ç­¾é¡µ -->
                <div class="tab-pane fade show active" id="performance" role="tabpanel">
                    <div class="row">
                        <!-- å®æ—¶æ€§èƒ½å›¾è¡¨ -->
                        <div class="col-md-6 mb-4">
                            <h5 class="mb-3">
                                <i class="fas fa-chart-area text-primary me-2"></i>CPU & å†…å­˜ä½¿ç”¨è¶‹åŠ¿
                            </h5>
                            <div class="performance-chart">
                                <canvas id="performanceChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <h5 class="mb-3">
                                <i class="fas fa-chart-bar text-success me-2"></i>ç£ç›˜I/Oç»Ÿè®¡
                            </h5>
                            <div class="performance-chart">
                                <canvas id="diskIOChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- è¿›ç¨‹åˆ—è¡¨ -->
                        <div class="col-md-12">
                            <h5 class="mb-3">
                                <i class="fas fa-list text-info me-2"></i>ç³»ç»Ÿè¿›ç¨‹ç›‘æ§ (Top 10)
                            </h5>
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>
                                                <i class="fas fa-hashtag me-1"></i>PID
                                            </th>
                                            <th>
                                                <i class="fas fa-cog me-1"></i>è¿›ç¨‹å
                                            </th>
                                            <th>
                                                <i class="fas fa-microchip me-1"></i>CPUä½¿ç”¨ç‡
                                            </th>
                                            <th>
                                                <i class="fas fa-memory me-1"></i>å†…å­˜ä½¿ç”¨ç‡
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="processTableBody">
                                        <tr>
                                            <td colspan="4" class="text-center py-5">
                                                <div class="spinner-border text-primary pulse-animation" role="status" style="width: 3rem; height: 3rem;">
                                                    <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                                </div>
                                                <p class="mt-3 text-muted fw-semibold">æ­£åœ¨åŠ è½½è¿›ç¨‹ä¿¡æ¯...</p>
                                                <small class="text-muted">å®æ—¶è·å–ç³»ç»Ÿè¿›ç¨‹æ•°æ®</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç³»ç»Ÿç»´æŠ¤æ ‡ç­¾é¡µ -->
                <div class="tab-pane fade" id="maintenance" role="tabpanel">
                    <div class="row">
                        <div class="col-md-12 mb-4">
                            <h5>
                                <i class="fas fa-broom text-warning me-2"></i>æ™ºèƒ½ç³»ç»Ÿæ¸…ç†å·¥å…·
                            </h5>
                            <p class="text-muted">å®šæœŸæ¸…ç†ç³»ç»Ÿåƒåœ¾æ–‡ä»¶ï¼Œé‡Šæ”¾å­˜å‚¨ç©ºé—´å¹¶æå‡ç³»ç»Ÿæ€§èƒ½</p>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="action-card" onclick="performCleanup('temp_files')">
                                <div class="action-icon">
                                    <i class="fas fa-trash-alt"></i>
                                </div>
                                <h6 class="fw-bold">æ¸…ç†ä¸´æ—¶æ–‡ä»¶</h6>
                                <p class="text-muted small mb-3">åˆ é™¤è¶…è¿‡1å°æ—¶çš„ä¸´æ—¶æ–‡ä»¶å’Œç¼“å­˜</p>
                                <button class="btn btn-outline-primary btn-sm">
                                    <i class="fas fa-play me-1"></i>å¼€å§‹æ¸…ç†
                                </button>
                            </div>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="action-card" onclick="performCleanup('orphaned_files')">
                                <div class="action-icon">
                                    <i class="fas fa-unlink"></i>
                                </div>
                                <h6 class="fw-bold">æ¸…ç†å­¤ç«‹æ–‡ä»¶</h6>
                                <p class="text-muted small mb-3">åˆ é™¤æ•°æ®åº“ä¸­ä¸å­˜åœ¨è®°å½•çš„æ–‡ä»¶</p>
                                <button class="btn btn-outline-warning btn-sm">
                                    <i class="fas fa-play me-1"></i>å¼€å§‹æ¸…ç†
                                </button>
                            </div>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="action-card" onclick="performCleanup('cache')">
                                <div class="action-icon">
                                    <i class="fas fa-memory"></i>
                                </div>
                                <h6 class="fw-bold">æ¸…ç†å†…å­˜ç¼“å­˜</h6>
                                <p class="text-muted small mb-3">é‡Šæ”¾Pythonåƒåœ¾å›æ”¶å†…å­˜</p>
                                <button class="btn btn-outline-success btn-sm">
                                    <i class="fas fa-play me-1"></i>å¼€å§‹æ¸…ç†
                                </button>
                            </div>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="action-card" onclick="performCleanup('logs')">
                                <div class="action-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <h6 class="fw-bold">æ¸…ç†æ—¥å¿—æ–‡ä»¶</h6>
                                <p class="text-muted small mb-3">æ¸…ç©ºå†å²ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶</p>
                                <button class="btn btn-outline-info btn-sm">
                                    <i class="fas fa-play me-1"></i>å¼€å§‹æ¸…ç†
                                </button>
                            </div>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="action-card" onclick="performCleanup('thumbnails')">
                                <div class="action-icon">
                                    <i class="fas fa-images"></i>
                                </div>
                                <h6 class="fw-bold">æ¸…ç†ç¼©ç•¥å›¾</h6>
                                <p class="text-muted small mb-3">åˆ é™¤æ‰€æœ‰ç”Ÿæˆçš„ç¼©ç•¥å›¾ç¼“å­˜</p>
                                <button class="btn btn-outline-secondary btn-sm">
                                    <i class="fas fa-play me-1"></i>å¼€å§‹æ¸…ç†
                                </button>
                            </div>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="action-card" onclick="optimizeDatabase()">
                                <div class="action-icon">
                                    <i class="fas fa-database"></i>
                                </div>
                                <h6 class="fw-bold">ä¼˜åŒ–æ•°æ®åº“</h6>
                                <p class="text-muted small mb-3">æ‰§è¡ŒVACUUMå’Œé‡å»ºç´¢å¼•æ“ä½œ</p>
                                <button class="btn btn-outline-primary btn-sm">
                                    <i class="fas fa-play me-1"></i>å¼€å§‹ä¼˜åŒ–
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ¸…ç†ç»“æœ -->
                    <div id="cleanupResults" class="mt-4" style="display: none;">
                        <h5>
                            <i class="fas fa-check-circle text-success me-2"></i>æ¸…ç†ç»“æœæŠ¥å‘Š
                        </h5>
                        <div id="cleanupResultsContent"></div>
                    </div>
                </div>

                <!-- ç³»ç»Ÿé…ç½®æ ‡ç­¾é¡µ -->
                <div class="tab-pane fade" id="config" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="config-section">
                                <h6>
                                    <i class="fas fa-database me-2"></i>æ•°æ®åº“é…ç½®
                                </h6>
                                <div id="databaseConfig">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary pulse-animation" role="status">
                                            <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                        </div>
                                        <p class="mt-2 text-muted">æ­£åœ¨åŠ è½½æ•°æ®åº“é…ç½®...</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="config-section">
                                <h6>
                                    <i class="fas fa-upload me-2"></i>ä¸Šä¼ é…ç½®
                                </h6>
                                <div id="uploadConfig">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary pulse-animation" role="status">
                                            <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                        </div>
                                        <p class="mt-2 text-muted">æ­£åœ¨åŠ è½½ä¸Šä¼ é…ç½®...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="config-section">
                                <h6>
                                    <i class="fas fa-key me-2"></i>JWTå®‰å…¨é…ç½®
                                </h6>
                                <div id="jwtConfig">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary pulse-animation" role="status">
                                            <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                        </div>
                                        <p class="mt-2 text-muted">æ­£åœ¨åŠ è½½JWTé…ç½®...</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="config-section">
                                <h6>
                                    <i class="fas fa-robot me-2"></i>AIæ™ºèƒ½é…ç½®
                                </h6>
                                <div id="aiConfig">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary pulse-animation" role="status">
                                            <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                        </div>
                                        <p class="mt-2 text-muted">æ­£åœ¨åŠ è½½AIé…ç½®...</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="config-section">
                                <h6>
                                    <i class="fas fa-cogs me-2"></i>åº”ç”¨ç¨‹åºé…ç½®
                                </h6>
                                <div id="appConfig">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary pulse-animation" role="status">
                                            <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                        </div>
                                        <p class="mt-2 text-muted">æ­£åœ¨åŠ è½½åº”ç”¨é…ç½®...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç³»ç»Ÿæ—¥å¿—æ ‡ç­¾é¡µ -->
                <div class="tab-pane fade" id="logs" role="tabpanel">
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5>
                                    <i class="fas fa-file-alt text-info me-2"></i>å®æ—¶ç³»ç»Ÿæ—¥å¿—
                                </h5>
                                <div class="d-flex gap-2">
                                    <select class="form-select form-select-sm" id="logTypeSelect" onchange="loadLogs()">
                                        <option value="application">ğŸ“± åº”ç”¨æ—¥å¿—</option>
                                        <option value="error">âŒ é”™è¯¯æ—¥å¿—</option>
                                        <option value="access">ğŸŒ è®¿é—®æ—¥å¿—</option>
                                    </select>
                                    <select class="form-select form-select-sm" id="logLinesSelect" onchange="loadLogs()">
                                        <option value="50">æœ€è¿‘50è¡Œ</option>
                                        <option value="100" selected>æœ€è¿‘100è¡Œ</option>
                                        <option value="200">æœ€è¿‘200è¡Œ</option>
                                        <option value="500">æœ€è¿‘500è¡Œ</option>
                                    </select>
                                    <button class="btn btn-outline-primary btn-sm" onclick="loadLogs()" data-tooltip="åˆ·æ–°æ—¥å¿—">
                                        <i class="fas fa-sync-alt me-1"></i>åˆ·æ–°
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-12">
                            <div class="log-container" id="logContainer">
                                <div class="text-center py-5">
                                    <div class="spinner-border text-light pulse-animation" role="status" style="width: 3rem; height: 3rem;">
                                        <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                    </div>
                                    <p class="mt-3 text-light fw-semibold">æ­£åœ¨åŠ è½½ç³»ç»Ÿæ—¥å¿—...</p>
                                    <small class="text-muted">å®æ—¶è·å–æœ€æ–°æ—¥å¿—ä¿¡æ¯</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å¤‡ä»½ç®¡ç†æ ‡ç­¾é¡µ -->
                <div class="tab-pane fade" id="backup" role="tabpanel">
                    <div class="row">
                        <div class="col-md-12 mb-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h5>
                                        <i class="fas fa-archive text-primary me-2"></i>æ™ºèƒ½å¤‡ä»½ç®¡ç†
                                    </h5>
                                    <p class="text-muted mb-0">è‡ªåŠ¨åŒ–å¤‡ä»½ç³»ç»Ÿï¼Œä¿éšœæ•°æ®å®‰å…¨</p>
                                </div>
                                <button class="btn btn-success" onclick="createBackup()" data-tooltip="åˆ›å»ºæ–°çš„ç³»ç»Ÿå¤‡ä»½">
                                    <i class="fas fa-plus me-2"></i>åˆ›å»ºæ–°å¤‡ä»½
                                </button>
                            </div>
                        </div>
                        
                        <div class="col-md-12">
                            <div id="backupsList">
                                <div class="text-center py-5">
                                    <div class="spinner-border text-primary pulse-animation" role="status" style="width: 3rem; height: 3rem;">
                                        <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                    </div>
                                    <p class="mt-3 text-muted fw-semibold">æ­£åœ¨åŠ è½½å¤‡ä»½åˆ—è¡¨...</p>
                                    <small class="text-muted">è·å–æ‰€æœ‰å¯ç”¨å¤‡ä»½æ–‡ä»¶</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½é®ç½© -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">åŠ è½½ä¸­...</span>
            </div>
            <h5 id="loadingText">ç³»ç»Ÿå¤„ç†ä¸­...</h5>
            <p class="text-muted mb-0">è¯·ç¨å€™ï¼Œæ­£åœ¨æ‰§è¡Œæ“ä½œ</p>
        </div>
    </div>
    
    <script>
        // å…¨å±€å˜é‡
        let performanceChart = null;
        let diskIOChart = null;
        let refreshInterval = null;
        let systemInfo = null;
        let performanceData = [];

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            initializeSystem();
            
            // è®¾ç½®è‡ªåŠ¨åˆ·æ–° (æ¯30ç§’)
            refreshInterval = setInterval(refreshMetrics, 30000);
        });

        // æ£€æŸ¥ç”¨æˆ·æƒé™
        async function checkAuth() {
            try {
                const response = await fetch('/api/auth/check');
                const data = await response.json();
                
                if (!data.authenticated) {
                    window.location.href = '/login?redirect=' + encodeURIComponent(window.location.pathname);
                    return;
                }
                
                if (data.user.role !== 'admin' && data.user.role !== 'moderator') {
                    showError('æ‚¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™è®¿é—®æ­¤é¡µé¢');
                    setTimeout(() => {
                        window.location.href = '/';
                    }, 2000);
                    return;
                }
            } catch (error) {
                console.error('æƒé™æ£€æŸ¥å¤±è´¥:', error);
                showError('æƒé™éªŒè¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•');
                setTimeout(() => {
                    window.location.href = '/login';
                }, 2000);
            }
        }

        // åˆå§‹åŒ–ç³»ç»Ÿ
        async function initializeSystem() {
            try {
                showLoading('æ­£åœ¨åˆå§‹åŒ–ç³»ç»Ÿç›‘æ§...');
                
                await loadSystemInfo();
                await loadPerformanceMetrics();
                await loadDatabaseStats();
                
                // åˆå§‹åŒ–å›¾è¡¨
                initializeCharts();
                
                showSuccess('ğŸš€ ç³»ç»Ÿç›‘æ§åˆå§‹åŒ–å®Œæˆï¼');
                console.log('âœ… ç³»ç»Ÿç›‘æ§åˆå§‹åŒ–å®Œæˆ');
            } catch (error) {
                console.error('âŒ ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:', error);
                showError('ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            } finally {
                hideLoading();
            }
        }

        // åŠ è½½ç³»ç»Ÿä¿¡æ¯
        async function loadSystemInfo() {
            try {
                const response = await fetch('/api/admin/system/info');
                const data = await response.json();
                
                if (data.success) {
                    systemInfo = data.data;
                    updateSystemMetrics(data.data);
                } else {
                    showError('åŠ è½½ç³»ç»Ÿä¿¡æ¯å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½ç³»ç»Ÿä¿¡æ¯å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼Œæ— æ³•è·å–ç³»ç»Ÿä¿¡æ¯');
            }
        }

        // åŠ è½½æ€§èƒ½æŒ‡æ ‡
        async function loadPerformanceMetrics() {
            try {
                const response = await fetch('/api/admin/system/performance');
                const data = await response.json();
                
                if (data.success) {
                    updatePerformanceData(data.data);
                } else {
                    showError('åŠ è½½æ€§èƒ½æ•°æ®å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½æ€§èƒ½æ•°æ®å¤±è´¥:', error);
                showWarning('æ€§èƒ½ç›‘æ§æš‚æ—¶ä¸å¯ç”¨');
            }
        }

        // åŠ è½½æ•°æ®åº“ç»Ÿè®¡
        async function loadDatabaseStats() {
            try {
                const response = await fetch('/api/admin/system/database-stats');
                const data = await response.json();
                
                if (data.success) {
                    updateDatabaseMetrics(data.data);
                } else {
                    showError('åŠ è½½æ•°æ®åº“ç»Ÿè®¡å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½æ•°æ®åº“ç»Ÿè®¡å¤±è´¥:', error);
                showWarning('æ•°æ®åº“ç»Ÿè®¡æš‚æ—¶ä¸å¯ç”¨');
            }
        }

        // æ›´æ–°ç³»ç»ŸæŒ‡æ ‡æ˜¾ç¤º
        function updateSystemMetrics(data) {
            // CPUä½¿ç”¨ç‡
            animateNumber('cpuUsage', `${data.system.cpu_percent.toFixed(1)}%`);
            document.getElementById('cpuCores').innerHTML = `<i class="fas fa-microchip me-1"></i>${data.system.cpu_count} æ ¸å¿ƒ`;
            
            // å†…å­˜ä½¿ç”¨ç‡
            animateNumber('memoryUsage', `${data.memory.percent.toFixed(1)}%`);
            document.getElementById('memoryDetails').innerHTML = 
                `<i class="fas fa-memory me-1"></i>${data.memory.used_gb.toFixed(1)}GB / ${data.memory.total_gb.toFixed(1)}GB`;
            
            // ç£ç›˜ä½¿ç”¨ç‡
            animateNumber('diskUsage', `${data.disk.percent.toFixed(1)}%`);
            document.getElementById('diskDetails').innerHTML = 
                `<i class="fas fa-hdd me-1"></i>${data.disk.used_gb.toFixed(1)}GB / ${data.disk.total_gb.toFixed(1)}GB`;
            
            // ä¸Šä¼ ç›®å½•å¤§å°
            if (data.upload_directory && data.upload_directory.size_gb) {
                animateNumber('dbSize', `${data.upload_directory.size_gb.toFixed(2)}GB`);
                document.getElementById('dbTables').innerHTML = 
                    `<i class="fas fa-file me-1"></i>${formatNumber(data.upload_directory.file_count)} æ–‡ä»¶`;
            }
            
            // æ›´æ–°æŒ‡æ ‡å¡ç‰‡é¢œè‰²
            updateMetricCardColors(data);
        }

        // æ•°å­—åŠ¨ç”»æ•ˆæœ
        function animateNumber(elementId, targetValue) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.style.transform = 'scale(1.1)';
            element.textContent = targetValue;
            
            setTimeout(() => {
                element.style.transform = 'scale(1)';
            }, 200);
        }

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        // æ›´æ–°æ€§èƒ½æ•°æ®
        function updatePerformanceData(data) {
            // æ›´æ–°è¿›ç¨‹åˆ—è¡¨
            updateProcessList(data.top_processes);
            
            // æ·»åŠ åˆ°æ€§èƒ½æ•°æ®å†å²
            const timestamp = new Date().toLocaleTimeString();
            performanceData.push({
                timestamp: timestamp,
                cpu: data.cpu ? data.cpu.percent : 0,
                memory: data.memory ? data.memory.virtual.percent : 0,
                disk_read: data.disk_io ? data.disk_io.read_bytes : 0,
                disk_write: data.disk_io ? data.disk_io.write_bytes : 0
            });
            
            // ä¿æŒæœ€è¿‘20ä¸ªæ•°æ®ç‚¹
            if (performanceData.length > 20) {
                performanceData.shift();
            }
            
            // æ›´æ–°å›¾è¡¨
            updatePerformanceChart();
            updateDiskIOChart();
        }

        // æ›´æ–°æ•°æ®åº“æŒ‡æ ‡
        function updateDatabaseMetrics(data) {
            if (data.database_file) {
                document.getElementById('dbSize').textContent = `${data.database_file.size_mb}MB`;
                document.getElementById('dbTables').innerHTML = 
                    `<i class="fas fa-table me-1"></i>${data.table_stats.users + data.table_stats.images} è®°å½•`;
            }
        }

        // æ›´æ–°æŒ‡æ ‡å¡ç‰‡é¢œè‰²
        function updateMetricCardColors(data) {
            // CPUé¢œè‰²
            const cpuCard = document.querySelector('#cpuUsage').closest('.metric-card').querySelector('.metric-icon');
            if (data.system.cpu_percent > 80) {
                cpuCard.className = 'metric-icon metric-danger';
            } else if (data.system.cpu_percent > 60) {
                cpuCard.className = 'metric-icon metric-warning';
            } else {
                cpuCard.className = 'metric-icon metric-primary';
            }
            
            // å†…å­˜é¢œè‰²
            const memCard = document.querySelector('#memoryUsage').closest('.metric-card').querySelector('.metric-icon');
            if (data.memory.percent > 85) {
                memCard.className = 'metric-icon metric-danger';
            } else if (data.memory.percent > 70) {
                memCard.className = 'metric-icon metric-warning';
            } else {
                memCard.className = 'metric-icon metric-success';
            }
                        // ç£ç›˜é¢œè‰²
            const diskCard = document.querySelector('#diskUsage').closest('.metric-card').querySelector('.metric-icon');
            if (data.disk.percent > 90) {
                diskCard.className = 'metric-icon metric-danger';
            } else if (data.disk.percent > 75) {
                diskCard.className = 'metric-icon metric-warning';
            } else {
                diskCard.className = 'metric-icon metric-warning';
            }
        }

        // æ›´æ–°è¿›ç¨‹åˆ—è¡¨
        function updateProcessList(processes) {
            const tbody = document.getElementById('processTableBody');
            
            if (!processes || processes.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" class="text-center py-5">
                            <i class="fas fa-exclamation-triangle fa-2x text-muted mb-3"></i>
                            <p class="text-muted mb-0">æš‚æ— è¿›ç¨‹æ•°æ®</p>
                            <small class="text-muted">ç³»ç»Ÿå¯èƒ½æ­£åœ¨åŠ è½½ä¸­</small>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = processes.map((proc, index) => `
                <tr class="animate-slide-up" style="animation-delay: ${index * 0.1}s;">
                    <td>
                        <span class="badge bg-primary">${proc.pid}</span>
                    </td>
                    <td>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-cog text-primary me-2"></i>
                            <span class="fw-semibold">${proc.name}</span>
                        </div>
                    </td>
                    <td>
                        <div class="d-flex align-items-center">
                            <div class="progress flex-grow-1 me-3" style="height: 8px;">
                                <div class="progress-bar bg-primary" 
                                     style="width: ${Math.min((proc.cpu_percent || 0), 100)}%"
                                     data-tooltip="CPU: ${(proc.cpu_percent || 0).toFixed(1)}%"></div>
                            </div>
                            <small class="fw-bold text-primary">${(proc.cpu_percent || 0).toFixed(1)}%</small>
                        </div>
                    </td>
                    <td>
                        <div class="d-flex align-items-center">
                            <div class="progress flex-grow-1 me-3" style="height: 8px;">
                                <div class="progress-bar bg-success" 
                                     style="width: ${Math.min((proc.memory_percent || 0), 100)}%"
                                     data-tooltip="å†…å­˜: ${(proc.memory_percent || 0).toFixed(1)}%"></div>
                            </div>
                            <small class="fw-bold text-success">${(proc.memory_percent || 0).toFixed(1)}%</small>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // åˆå§‹åŒ–å›¾è¡¨
        function initializeCharts() {
            // æ€§èƒ½ç›‘æ§å›¾è¡¨
            const perfCtx = document.getElementById('performanceChart');
            if (perfCtx) {
                performanceChart = new Chart(perfCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'CPUä½¿ç”¨ç‡',
                                data: [],
                                borderColor: '#667eea',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                tension: 0.4,
                                fill: true,
                                pointBackgroundColor: '#667eea',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 6,
                                pointHoverRadius: 8
                            },
                            {
                                label: 'å†…å­˜ä½¿ç”¨ç‡',
                                data: [],
                                borderColor: '#56ab2f',
                                backgroundColor: 'rgba(86, 171, 47, 0.1)',
                                tension: 0.4,
                                fill: true,
                                pointBackgroundColor: '#56ab2f',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 6,
                                pointHoverRadius: 8
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                borderColor: '#667eea',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    maxTicksLimit: 10
                                }
                            },
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                },
                                grid: {
                                    color: 'rgba(0,0,0,0.05)'
                                }
                            }
                        },
                        animation: {
                            duration: 750,
                            easing: 'easeInOutQuart'
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });
            }
            
            // ç£ç›˜I/Oå›¾è¡¨
            const diskCtx = document.getElementById('diskIOChart');
            if (diskCtx) {
                diskIOChart = new Chart(diskCtx, {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'è¯»å– (MB)',
                                data: [],
                                backgroundColor: 'rgba(79, 172, 254, 0.8)',
                                borderColor: 'rgba(79, 172, 254, 1)',
                                borderWidth: 2,
                                borderRadius: 8,
                                borderSkipped: false
                            },
                            {
                                label: 'å†™å…¥ (MB)',
                                data: [],
                                backgroundColor: 'rgba(240, 147, 251, 0.8)',
                                borderColor: 'rgba(240, 147, 251, 1)',
                                borderWidth: 2,
                                borderRadius: 8,
                                borderSkipped: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                borderColor: '#4facfe',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    maxTicksLimit: 8
                                }
                            },
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value + ' MB';
                                    }
                                },
                                grid: {
                                    color: 'rgba(0,0,0,0.05)'
                                }
                            }
                        },
                        animation: {
                            duration: 750,
                            easing: 'easeInOutQuart'
                        }
                    }
                });
            }
        }

        // æ›´æ–°æ€§èƒ½å›¾è¡¨
        function updatePerformanceChart() {
            if (!performanceChart || performanceData.length === 0) return;
            
            const labels = performanceData.map(d => d.timestamp);
            const cpuData = performanceData.map(d => d.cpu);
            const memoryData = performanceData.map(d => d.memory);
            
            performanceChart.data.labels = labels;
            performanceChart.data.datasets[0].data = cpuData;
            performanceChart.data.datasets[1].data = memoryData;
            performanceChart.update('none');
        }

        // æ›´æ–°ç£ç›˜I/Oå›¾è¡¨
        function updateDiskIOChart() {
            if (!diskIOChart || performanceData.length === 0) return;
            
            const labels = performanceData.slice(-10).map(d => d.timestamp);
            const readData = performanceData.slice(-10).map(d => (d.disk_read / (1024*1024)).toFixed(2));
            const writeData = performanceData.slice(-10).map(d => (d.disk_write / (1024*1024)).toFixed(2));
            
            diskIOChart.data.labels = labels;
            diskIOChart.data.datasets[0].data = readData;
            diskIOChart.data.datasets[1].data = writeData;
            diskIOChart.update('none');
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢å‡½æ•°
        function showPerformanceTab() {
            console.log('ğŸ”„ åˆ‡æ¢åˆ°æ€§èƒ½ç›‘æ§æ ‡ç­¾é¡µ');
            // å›¾è¡¨å·²ç»åœ¨åˆå§‹åŒ–æ—¶åˆ›å»ºï¼Œè¿™é‡Œåªéœ€è¦åˆ·æ–°æ•°æ®
            setTimeout(() => {
                if (performanceChart) performanceChart.resize();
                if (diskIOChart) diskIOChart.resize();
            }, 100);
        }

        function showMaintenanceTab() {
            console.log('ğŸ”§ åˆ‡æ¢åˆ°ç³»ç»Ÿç»´æŠ¤æ ‡ç­¾é¡µ');
            // æ¸…ç†ç»“æœé‡ç½®
            document.getElementById('cleanupResults').style.display = 'none';
        }

        async function showConfigTab() {
            console.log('âš™ï¸ åˆ‡æ¢åˆ°ç³»ç»Ÿé…ç½®æ ‡ç­¾é¡µ');
            await loadSystemConfig();
        }

        async function showLogsTab() {
            console.log('ğŸ“ åˆ‡æ¢åˆ°ç³»ç»Ÿæ—¥å¿—æ ‡ç­¾é¡µ');
            await loadLogs();
        }

        async function showBackupTab() {
            console.log('ğŸ’¾ åˆ‡æ¢åˆ°å¤‡ä»½ç®¡ç†æ ‡ç­¾é¡µ');
            await loadBackups();
        }

        // ç³»ç»Ÿæ¸…ç†åŠŸèƒ½
        async function performCleanup(cleanupType) {
            const typeNames = {
                'temp_files': 'ä¸´æ—¶æ–‡ä»¶',
                'orphaned_files': 'å­¤ç«‹æ–‡ä»¶',
                'cache': 'å†…å­˜ç¼“å­˜',
                'logs': 'æ—¥å¿—æ–‡ä»¶',
                'thumbnails': 'ç¼©ç•¥å›¾ç¼“å­˜'
            };
            
            const typeIcons = {
                'temp_files': 'ğŸ—‘ï¸',
                'orphaned_files': 'ğŸ”—',
                'cache': 'ğŸ’¾',
                'logs': 'ğŸ“„',
                'thumbnails': 'ğŸ–¼ï¸'
            };
            
            const typeName = typeNames[cleanupType] || cleanupType;
            const typeIcon = typeIcons[cleanupType] || 'ğŸ”§';
            
            if (!confirm(`${typeIcon} ç¡®å®šè¦æ¸…ç†${typeName}å—ï¼Ÿ\n\nâš ï¸ æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œå»ºè®®å…ˆåˆ›å»ºå¤‡ä»½ã€‚`)) {
                return;
            }
            
            try {
                showLoading(`æ­£åœ¨æ¸…ç†${typeName}...`);
                
                const response = await fetch(`/api/admin/system/cleanup?cleanup_type=${cleanupType}`, {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showCleanupResults(result.data);
                    showSuccess(`âœ… ${typeName}æ¸…ç†å®Œæˆï¼`);
                    
                    // åˆ·æ–°ç³»ç»Ÿä¿¡æ¯
                    setTimeout(loadSystemInfo, 1000);
                } else {
                    showError(`âŒ æ¸…ç†${typeName}å¤±è´¥ï¼š${result.message || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (error) {
                console.error('æ¸…ç†å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // æ˜¾ç¤ºæ¸…ç†ç»“æœ
        function showCleanupResults(data) {
            const resultsDiv = document.getElementById('cleanupResults');
            const contentDiv = document.getElementById('cleanupResultsContent');
            
            let resultHtml = `
                <div class="alert alert-success animate-slide-up">
                    <div class="d-flex align-items-start">
                        <i class="fas fa-check-circle fa-2x text-success me-3"></i>
                        <div class="flex-grow-1">
                            <h6 class="fw-bold mb-2">æ¸…ç†æ“ä½œæˆåŠŸå®Œæˆ</h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="text-center p-2 bg-white bg-opacity-50 rounded">
                                        <div class="fw-bold text-primary">${data.files_removed || 0}</div>
                                        <small class="text-muted">åˆ é™¤æ–‡ä»¶æ•°</small>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="text-center p-2 bg-white bg-opacity-50 rounded">
                                        <div class="fw-bold text-success">${formatFileSize(data.space_freed || 0)}</div>
                                        <small class="text-muted">é‡Šæ”¾ç©ºé—´</small>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="text-center p-2 bg-white bg-opacity-50 rounded">
                                        <div class="fw-bold text-info">${data.type || 'æœªçŸ¥'}</div>
                                        <small class="text-muted">æ¸…ç†ç±»å‹</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            if (data.details && data.details.length > 0) {
                resultHtml += `
                    <div class="card mt-3 animate-slide-up" style="animation-delay: 0.2s;">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-list text-info me-2"></i>æ¸…ç†è¯¦æƒ…
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="cleanup-details">
                                ${data.details.map(detail => `
                                    <div class="d-flex align-items-center mb-2">
                                        <i class="fas fa-check text-success me-2"></i>
                                        <span class="small">${detail}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            if (data.errors && data.errors.length > 0) {
                resultHtml += `
                    <div class="card mt-3 border-warning animate-slide-up" style="animation-delay: 0.3s;">
                        <div class="card-header bg-warning bg-opacity-10">
                            <h6 class="mb-0 text-warning">
                                <i class="fas fa-exclamation-triangle me-2"></i>æ³¨æ„äº‹é¡¹
                            </h6>
                        </div>
                        <div class="card-body">
                            ${data.errors.map(error => `
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-exclamation-circle text-warning me-2"></i>
                                    <span class="small">${error}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            contentDiv.innerHTML = resultHtml;
            resultsDiv.style.display = 'block';
            
            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            setTimeout(() => {
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        // æ•°æ®åº“ä¼˜åŒ–
        async function optimizeDatabase() {
            if (!confirm('ğŸ”§ ç¡®å®šè¦ä¼˜åŒ–æ•°æ®åº“å—ï¼Ÿ\n\nâ±ï¸ è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ï¼ŒæœŸé—´ç³»ç»Ÿå¯èƒ½ä¼šç¨æ…¢ã€‚\nğŸ’¡ å»ºè®®åœ¨ç³»ç»Ÿç©ºé—²æ—¶è¿›è¡Œæ­¤æ“ä½œã€‚')) {
                return;
            }
            
            try {
                showLoading('æ­£åœ¨æ‰§è¡Œæ•°æ®åº“ä¼˜åŒ–...');
                
                const response = await fetch('/api/admin/system/optimize-database', {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const data = result.data;
                    let message = 'ğŸ‰ æ•°æ®åº“ä¼˜åŒ–å®Œæˆï¼\n\nğŸ“‹ æ‰§è¡Œçš„æ“ä½œ:\n';
                    
                    data.operations.forEach(op => {
                        message += `â€¢ ${op}\n`;
                    });
                    
                    if (data.space_saved > 0) {
                        message += `\nğŸ’¾ é‡Šæ”¾ç©ºé—´: ${formatFileSize(data.space_saved)}`;
                    }
                    
                    if (data.performance_improvement) {
                        message += `\nâš¡ æ€§èƒ½æå‡: ${data.performance_improvement}`;
                    }
                    
                    alert(message);
                    showSuccess('âœ… æ•°æ®åº“ä¼˜åŒ–å®Œæˆï¼');
                    
                    // åˆ·æ–°ç³»ç»Ÿä¿¡æ¯
                    setTimeout(loadDatabaseStats, 1000);
                } else {
                    showError('âŒ æ•°æ®åº“ä¼˜åŒ–å¤±è´¥ï¼š' + (result.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('æ•°æ®åº“ä¼˜åŒ–å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // åŠ è½½ç³»ç»Ÿé…ç½®
        async function loadSystemConfig() {
            try {
                showLoading('æ­£åœ¨åŠ è½½ç³»ç»Ÿé…ç½®...');
                
                const response = await fetch('/api/admin/system/config');
                const data = await response.json();
                
                if (data.success) {
                    displaySystemConfig(data.data);
                } else {
                    showError('åŠ è½½ç³»ç»Ÿé…ç½®å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½ç³»ç»Ÿé…ç½®å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼Œæ— æ³•è·å–ç³»ç»Ÿé…ç½®');
            } finally {
                hideLoading();
            }
        }

        // æ˜¾ç¤ºç³»ç»Ÿé…ç½®
        function displaySystemConfig(config) {
            // æ•°æ®åº“é…ç½®
            document.getElementById('databaseConfig').innerHTML = `
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-database me-1"></i>æ•°æ®åº“ç±»å‹
                    </span>
                    <span class="config-value">${config.database?.type || 'SQLite'}</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-link me-1"></i>è¿æ¥é…ç½®
                    </span>
                    <span class="config-value">${config.database?.url_pattern || 'sqlite:///ai_pose_db.sqlite'}</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-bolt me-1"></i>è¿æ¥æ± å¤§å°
                    </span>
                    <span class="config-value">${config.database?.pool_size || 'é»˜è®¤'}</span>
                </div>
            `;
            
            // ä¸Šä¼ é…ç½®
            document.getElementById('uploadConfig').innerHTML = `
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-folder me-1"></i>ä¸Šä¼ ç›®å½•
                    </span>
                    <span class="config-value">${config.upload?.directory || './uploads'}</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-weight-hanging me-1"></i>æœ€å¤§æ–‡ä»¶å¤§å°
                    </span>
                    <span class="config-value">${config.upload?.max_file_size_mb || 10}MB</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-file-image me-1"></i>å…è®¸çš„æ ¼å¼
                    </span>
                    <span class="config-value">${config.upload?.allowed_extensions?.join(', ') || 'jpg, png, gif'}</span>
                </div>
            `;
            
            // JWTé…ç½®
            document.getElementById('jwtConfig').innerHTML = `
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-shield-alt me-1"></i>åŠ å¯†ç®—æ³•
                    </span>
                    <span class="config-value">${config.jwt?.algorithm || 'HS256'}</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-clock me-1"></i>ä»¤ç‰Œæœ‰æ•ˆæœŸ
                    </span>
                    <span class="config-value">${config.jwt?.expire_minutes || 60}åˆ†é’Ÿ</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-key me-1"></i>å¯†é’¥çŠ¶æ€
                    </span>
                    <span class="config-value">
                        <span class="badge bg-${config.jwt?.secret_key_configured ? 'success' : 'danger'}">
                            ${config.jwt?.secret_key_configured ? 'âœ… å·²é…ç½®' : 'âŒ æœªé…ç½®'}
                        </span>
                    </span>
                </div>
            `;
            
            // AIé…ç½®
            document.getElementById('aiConfig').innerHTML = `
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-brain me-1"></i>OpenAI API
                    </span>
                    <span class="config-value">
                        <span class="badge bg-${config.ai?.openai_configured ? 'success' : 'warning'}">
                            ${config.ai?.openai_configured ? 'ğŸ¤– å·²é…ç½®' : 'âš ï¸ æœªé…ç½®'}
                        </span>
                    </span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-language me-1"></i>é»˜è®¤æ¨¡å‹
                    </span>
                    <span class="config-value">${config.ai?.default_model || 'gpt-3.5-turbo'}</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-thermometer-half me-1"></i>åˆ†ææ¸©åº¦
                    </span>
                    <span class="config-value">${config.ai?.temperature || 0.7}</span>
                </div>
            `;
            
            // åº”ç”¨é…ç½®
            document.getElementById('appConfig').innerHTML = `
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-server me-1"></i>è¿è¡Œç¯å¢ƒ
                    </span>
                    <span class="config-value">
                        <span class="badge bg-${config.application?.environment === 'production' ? 'success' : 'warning'}">
                            ${config.application?.environment || 'development'}
                        </span>
                    </span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-bug me-1"></i>è°ƒè¯•æ¨¡å¼
                    </span>
                    <span class="config-value">
                        <span class="badge bg-${config.application?.debug ? 'warning' : 'success'}">
                            ${config.application?.debug ? 'ğŸ› å¯ç”¨' : 'ğŸ”’ ç¦ç”¨'}
                        </span>
                    </span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-tag me-1"></i>åº”ç”¨ç‰ˆæœ¬
                    </span>
                    <span class="config-value">${config.application?.version || '1.0.0'}</span>
                </div>
                <div class="config-item">
                    <span class="config-label">
                        <i class="fas fa-calendar me-1"></i>å¯åŠ¨æ—¶é—´
                    </span>
                    <span class="config-value">${config.application?.start_time || new Date().toLocaleString('zh-CN')}</span>
                </div>
            `;
        }

        // åŠ è½½ç³»ç»Ÿæ—¥å¿—
        async function loadLogs() {
            const logType = document.getElementById('logTypeSelect').value;
            const lines = document.getElementById('logLinesSelect').value;
            
            try {
                showLoading('æ­£åœ¨åŠ è½½ç³»ç»Ÿæ—¥å¿—...');
                
                const response = await fetch(`/api/admin/system/logs?log_type=${logType}&lines=${lines}`);
                const data = await response.json();
                
                if (data.success) {
                    displayLogs(data.data);
                } else {
                    showError('åŠ è½½æ—¥å¿—å¤±è´¥ï¼š' + (data.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('åŠ è½½æ—¥å¿—å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼Œæ— æ³•è·å–ç³»ç»Ÿæ—¥å¿—');
            } finally {
                hideLoading();
            }
        }

        // æ˜¾ç¤ºæ—¥å¿—
        function displayLogs(logData) {
            const container = document.getElementById('logContainer');
            
            if (!logData.content || logData.content.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-file-alt fa-3x text-muted mb-3"></i>
                        <h5 class="text-light">æ—¥å¿—æ–‡ä»¶ä¸ºç©º</h5>
                        <p class="text-muted">å½“å‰æ—¥å¿—ç±»å‹æš‚æ— å†…å®¹ï¼Œæˆ–è€…æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨</p>
                        <button class="btn btn-outline-light btn-sm" onclick="loadLogs()">
                            <i class="fas fa-refresh me-1"></i>é‡æ–°åŠ è½½
                        </button>
                    </div>
                `;
                return;
            }
            
            const logHtml = logData.content.map((line, index) => {
                // æ™ºèƒ½æ—¥å¿—çº§åˆ«æ£€æµ‹
                let logClass = '';
                let icon = '';
                
                if (line.toLowerCase().includes('error') || line.toLowerCase().includes('exception')) {
                    logClass = 'log-level-error';
                    icon = '<i class="fas fa-exclamation-triangle me-2"></i>';
                } else if (line.toLowerCase().includes('warning') || line.toLowerCase().includes('warn')) {
                    logClass = 'log-level-warning';
                    icon = '<i class="fas fa-exclamation-circle me-2"></i>';
                } else if (line.toLowerCase().includes('info')) {
                    logClass = 'log-level-info';
                    icon = '<i class="fas fa-info-circle me-2"></i>';
                } else {
                    icon = '<i class="fas fa-circle me-2" style="font-size: 0.5rem;"></i>';
                }
                
                return `
                    <div class="log-line ${logClass}" style="animation-delay: ${index * 0.02}s;">
                        ${icon}${escapeHtml(line)}
                    </div>
                `;
            }).join('');
            
            container.innerHTML = `
                <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom border-secondary">
                    <div class="text-light">
                        <i class="fas fa-terminal me-2"></i>
                        <strong>${logData.log_type || 'ç³»ç»Ÿ'} æ—¥å¿—</strong>
                        <span class="badge bg-primary ms-2">${logData.content.length} è¡Œ</span>
                    </div>
                    <div class="text-muted small">
                        æœ€åæ›´æ–°: ${new Date().toLocaleString('zh-CN')}
                    </div>
                </div>
                ${logHtml}
            `;
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            setTimeout(() => {
                container.scrollTop = container.scrollHeight;
            }, 100);
        }

        // å¤‡ä»½ç®¡ç†åŠŸèƒ½
        async function loadBackups() {
            try {
                showLoading('æ­£åœ¨åŠ è½½å¤‡ä»½åˆ—è¡¨...');
                
                const response = await fetch('/api/admin/system/backups');
                const data = await response.json();
                
                if (data.success) {
                    displayBackups(data.data);
                } else {
                    showError('åŠ è½½å¤‡ä»½åˆ—è¡¨å¤±è´¥ï¼š' + (data.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('åŠ è½½å¤‡ä»½åˆ—è¡¨å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼Œæ— æ³•è·å–å¤‡ä»½åˆ—è¡¨');
            } finally {
                hideLoading();
            }
        }

        // æ˜¾ç¤ºå¤‡ä»½åˆ—è¡¨
        function displayBackups(backupData) {
            const container = document.getElementById('backupsList');
            
            if (!backupData.backups || backupData.backups.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-archive fa-4x text-muted mb-4"></i>
                        <h5 class="text-muted">æš‚æ— å¤‡ä»½æ–‡ä»¶</h5>
                        <p class="text-muted">ç³»ç»Ÿè¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•å¤‡ä»½ï¼Œå»ºè®®å®šæœŸå¤‡ä»½ä»¥ä¿éšœæ•°æ®å®‰å…¨</p>
                        <button class="btn btn-primary" onclick="createBackup()">
                            <i class="fas fa-plus me-2"></i>åˆ›å»ºç¬¬ä¸€ä¸ªå¤‡ä»½
                        </button>
                    </div>
                `;
                return;
            }
            
            const backupsHtml = `
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="card text-center bg-primary bg-opacity-10 border-primary">
                            <div class="card-body">
                                <i class="fas fa-archive fa-2x text-primary mb-2"></i>
                                <h4 class="text-primary">${backupData.count || 0}</h4>
                                <small class="text-muted">å¤‡ä»½æ€»æ•°</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center bg-success bg-opacity-10 border-success">
                            <div class="card-body">
                                <i class="fas fa-hdd fa-2x text-success mb-2"></i>
                                <h4 class="text-success">${formatFileSize(backupData.total_size || 0)}</h4>
                                <small class="text-muted">æ€»å­˜å‚¨å¤§å°</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center bg-info bg-opacity-10 border-info">
                            <div class="card-body">
                                <i class="fas fa-clock fa-2x text-info mb-2"></i>
                                <h4 class="text-info">${getLatestBackupTime(backupData.backups)}</h4>
                                <small class="text-muted">æœ€æ–°å¤‡ä»½</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                ${backupData.backups.map((backup, index) => `
                    <div class="backup-item animate-slide-up" style="animation-delay: ${index * 0.1}s;">
                        <div class="row align-items-center">
                            <div class="col-md-7">
                                <h6 class="mb-1 fw-bold">
                                    <i class="fas fa-archive text-primary me-2"></i>
                                    ${backup.name}
                                </h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <small class="text-muted">
                                            <i class="fas fa-calendar me-1"></i>
                                            åˆ›å»ºæ—¶é—´: ${backup.timestamp !== 'unknown' ? formatTimestamp(backup.timestamp) : 'æœªçŸ¥'}
                                        </small>
                                    </div>
                                    <div class="col-md-6">
                                        <small class="text-muted">
                                            <i class="fas fa-weight-hanging me-1"></i>
                                            å¤§å°: ${formatFileSize(backup.size || 0)}
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 text-center">
                                <div class="fw-bold text-primary">${backup.files ? backup.files.length : 0}</div>
                                <small class="text-muted">æ–‡ä»¶æ•°é‡</small>
                            </div>
                            <div class="col-md-3 text-end">
                                <div class="btn-group" role="group">
                                    <button class="btn btn-outline-info btn-sm" onclick="viewBackupDetails('${backup.name}')" data-tooltip="æŸ¥çœ‹å¤‡ä»½è¯¦æƒ…">
                                        <i class="fas fa-info-circle"></i>
                                    </button>
                                    <button class="btn btn-outline-success btn-sm" onclick="downloadBackup('${backup.name}')" data-tooltip="ä¸‹è½½å¤‡ä»½æ–‡ä»¶">
                                        <i class="fas fa-download"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="deleteBackup('${backup.name}')" data-tooltip="åˆ é™¤å¤‡ä»½æ–‡ä»¶">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        ${backup.files && backup.files.length > 0 ? `
                        <div class="mt-3 pt-3 border-top">
                            <small class="text-muted fw-semibold">
                                <i class="fas fa-folder me-1"></i>åŒ…å«æ–‡ä»¶:
                            </small>
                            <div class="d-flex flex-wrap gap-1 mt-2">
                                ${backup.files.slice(0, 8).map(file => `
                                    <span class="badge bg-light text-dark border">
                                        <i class="fas fa-file me-1"></i>${file.name}
                                    </span>
                                `).join('')}
                                ${backup.files.length > 8 ? `
                                    <span class="badge bg-secondary">
                                        <i class="fas fa-ellipsis-h me-1"></i>+${backup.files.length - 8}
                                    </span>
                                ` : ''}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `).join('')}
            `;
            
            container.innerHTML = backupsHtml;
        }

        // åˆ›å»ºå¤‡ä»½
        async function createBackup() {
            const includeUploads = confirm('ğŸ’¾ å¤‡ä»½é€‰é¡¹è®¾ç½®ï¼š\n\nâœ… ç¡®å®š = å®Œæ•´å¤‡ä»½ï¼ˆåŒ…å«ä¸Šä¼ æ–‡ä»¶ï¼Œå¤‡ä»½è¾ƒå¤§ï¼‰\nâŒ å–æ¶ˆ = å¿«é€Ÿå¤‡ä»½ï¼ˆä»…å¤‡ä»½æ•°æ®åº“å’Œé…ç½®ï¼‰\n\nå»ºè®®ï¼šé¦–æ¬¡å¤‡ä»½é€‰æ‹©å®Œæ•´å¤‡ä»½');
            
            try {
                showLoading('æ­£åœ¨åˆ›å»ºç³»ç»Ÿå¤‡ä»½...');
                
                const response = await fetch(`/api/admin/system/backup?include_uploads=${includeUploads}`, {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showSuccess(`âœ… å¤‡ä»½åˆ›å»ºæˆåŠŸï¼\n\nğŸ“ å¤‡ä»½åç§°: ${result.data.name}\nğŸ’¾ æ–‡ä»¶å¤§å°: ${formatFileSize(result.data.size || 0)}`);
                    loadBackups(); // åˆ·æ–°å¤‡ä»½åˆ—è¡¨
                } else {
                    showError('âŒ åˆ›å»ºå¤‡ä»½å¤±è´¥ï¼š' + (result.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('åˆ›å»ºå¤‡ä»½å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // æŸ¥çœ‹å¤‡ä»½è¯¦æƒ…
        async function viewBackupDetails(backupName) {
            try {
                showLoading('æ­£åœ¨åŠ è½½å¤‡ä»½è¯¦æƒ…...');
                
                const response = await fetch(`/api/admin/system/backup/${encodeURIComponent(backupName)}/details`);
                const result = await response.json();
                
                if (result.success) {
                    const data = result.data;
                    
                    let detailsHtml = `
                        ğŸ“ å¤‡ä»½åç§°: ${data.name}
                        ğŸ“… åˆ›å»ºæ—¶é—´: ${data.timestamp ? formatTimestamp(data.timestamp) : 'æœªçŸ¥'}
                        ğŸ’¾ æ–‡ä»¶å¤§å°: ${formatFileSize(data.size || 0)}
                        ğŸ“Š æ–‡ä»¶æ•°é‡: ${data.files ? data.files.length : 0}
                    `;
                    
                    if (data.files && data.files.length > 0) {
                        detailsHtml += '\n\nğŸ“‹ åŒ…å«æ–‡ä»¶:\n';
                        data.files.forEach(file => {
                            detailsHtml += `â€¢ ${file.name} (${formatFileSize(file.size || 0)})\n`;
                        });
                    }
                    
                    alert(detailsHtml);
                } else {
                    showError('è·å–å¤‡ä»½è¯¦æƒ…å¤±è´¥');
                }
            } catch (error) {
                console.error('è·å–å¤‡ä»½è¯¦æƒ…å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // ä¸‹è½½å¤‡ä»½
        function downloadBackup(backupName) {
            if (confirm(`ğŸ“¥ ç¡®å®šè¦ä¸‹è½½å¤‡ä»½ "${backupName}" å—ï¼Ÿ\n\nä¸‹è½½å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚`)) {
                const downloadUrl = `/api/admin/system/backup/${encodeURIComponent(backupName)}/download`;
                const a = document.createElement('a');
                a.href = downloadUrl;
                a.download = backupName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                showInfo('ğŸ“¥ å¤‡ä»½ä¸‹è½½å·²å¼€å§‹ï¼Œè¯·æŸ¥çœ‹æµè§ˆå™¨ä¸‹è½½è¿›åº¦');
            }
        }

        // åˆ é™¤å¤‡ä»½
        async function deleteBackup(backupName) {
            if (!confirm(`ğŸ—‘ï¸ ç¡®å®šè¦åˆ é™¤å¤‡ä»½ "${backupName}" å—ï¼Ÿ\n\nâš ï¸ æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œåˆ é™¤åæ— æ³•æ¢å¤ï¼`)) {
                return;
            }
            
            try {
                showLoading('æ­£åœ¨åˆ é™¤å¤‡ä»½...');
                
                const response = await fetch(`/api/admin/system/backup/${encodeURIComponent(backupName)}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showSuccess(`âœ… å¤‡ä»½ "${backupName}" å·²æˆåŠŸåˆ é™¤`);
                    loadBackups(); // åˆ·æ–°å¤‡ä»½åˆ—è¡¨
                } else {
                    showError('âŒ åˆ é™¤å¤‡ä»½å¤±è´¥ï¼š' + (result.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('åˆ é™¤å¤‡ä»½å¤±è´¥:', error);
                showError('ç½‘ç»œé”™è¯¯ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // åˆ·æ–°æ‰€æœ‰æ•°æ®
        async function refreshAllData() {
            try {
                showLoading('æ­£åœ¨åˆ·æ–°æ‰€æœ‰ç³»ç»Ÿæ•°æ®...');
                
                await Promise.all([
                    loadSystemInfo(),
                    loadPerformanceMetrics(),
                    loadDatabaseStats()
                ]);
                
                showSuccess('ğŸ”„ ç³»ç»Ÿæ•°æ®å·²å…¨éƒ¨åˆ·æ–°ï¼');
            } catch (error) {
                console.error('åˆ·æ–°æ•°æ®å¤±è´¥:', error);
                showError('åˆ·æ–°æ•°æ®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
            } finally {
                hideLoading();
            }
        }

        // å®šæœŸåˆ·æ–°æŒ‡æ ‡
        async function refreshMetrics() {
            try {
                await loadPerformanceMetrics();
                console.log('ğŸ“Š æ€§èƒ½æŒ‡æ ‡å·²è‡ªåŠ¨åˆ·æ–° -', new Date().toLocaleTimeString());
            } catch (error) {
                console.error('è‡ªåŠ¨åˆ·æ–°å¤±è´¥:', error);
            }
        }

        // è¾…åŠ©å‡½æ•°
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function formatTimestamp(timestamp) {
            if (!timestamp || timestamp === 'unknown') return 'æœªçŸ¥';
            
            // å¦‚æœæ˜¯YYYYMMDD_HHMMSSæ ¼å¼
            if (timestamp.includes('_')) {
                const [datePart, timePart] = timestamp.split('_');
                const year = datePart.substring(0, 4);
                const month = datePart.substring(4, 6);
                const day = datePart.substring(6, 8);
                const hour = timePart.substring(0, 2);
                const minute = timePart.substring(2, 4);
                const second = timePart.substring(4, 6);
                
                return `${year}-${month}-${day} ${hour}:${minute}:${second}`;
            }
            
            // å°è¯•è§£æå…¶ä»–æ ¼å¼
            try {
                const date = new Date(timestamp);
                return date.toLocaleString('zh-CN');
            } catch (e) {
                return timestamp;
            }
        }

        function getLatestBackupTime(backups) {
            if (!backups || backups.length === 0) return 'æ— ';
            
            const latest = backups.reduce((latest, current) => {
                if (!latest.timestamp) return current;
                if (!current.timestamp) return latest;
                return current.timestamp > latest.timestamp ? current : latest;
            });
            
            if (latest.timestamp && latest.timestamp !== 'unknown') {
                const time = formatTimestamp(latest.timestamp);
                return time.includes(' ') ? time.split(' ')[0] : time;
            }
            
            return 'æœªçŸ¥';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ===== UIé€šçŸ¥ç³»ç»Ÿ =====
        function showLoading(text = 'ç³»ç»Ÿå¤„ç†ä¸­...') {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingOverlay').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        function showSuccess(message) {
            showNotification(message, 'success', 5000);
        }

        function showError(message) {
            showNotification(message, 'danger', 8000);
        }

        function showWarning(message) {
            showNotification(message, 'warning', 6000);
        }

        function showInfo(message) {
            showNotification(message, 'info', 4000);
        }

        function showNotification(message, type, duration) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed animate-slide-up`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 10000; min-width: 350px; max-width: 500px;';
            
            const icon = getNotificationIcon(type);
            alertDiv.innerHTML = `
                <div class="d-flex align-items-start">
                    <div class="me-2">${icon}</div>
                    <div class="flex-grow-1">${message.replace(/\n/g, '<br>')}</div>
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            document.body.appendChild(alertDiv);
            
            // è‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.classList.remove('show');
                    setTimeout(() => {
                        if (alertDiv.parentNode) {
                            alertDiv.parentNode.removeChild(alertDiv);
                        }
                    }, 300);
                }
            }, duration);
        }

        function getNotificationIcon(type) {
            const iconMap = {
                'success': '<i class="fas fa-check-circle fa-lg text-success"></i>',
                'danger': '<i class="fas fa-exclamation-triangle fa-lg text-danger"></i>',
                'warning': '<i class="fas fa-exclamation-circle fa-lg text-warning"></i>',
                'info': '<i class="fas fa-info-circle fa-lg text-info"></i>'
            };
            return iconMap[type] || '<i class="fas fa-bell fa-lg"></i>';
        }

        // ===== é”®ç›˜å¿«æ·é”®æ”¯æŒ =====
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + R: åˆ·æ–°æ•°æ®
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                refreshAllData();
            }
            
            // Ctrl/Cmd + B: åˆ›å»ºå¤‡ä»½
            if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
                e.preventDefault();
                createBackup();
            }
            
            // Ctrl/Cmd + L: åˆ·æ–°æ—¥å¿—
            if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
                e.preventDefault();
                if (document.getElementById('logs-tab').classList.contains('active')) {
                    loadLogs();
                }
            }
            
            // ESC: å…³é—­åŠ è½½é®ç½©
            if (e.key === 'Escape') {
                hideLoading();
            }
        });

        // ===== é¡µé¢å¯è§æ€§æ£€æµ‹ =====
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                // é¡µé¢é‡æ–°å¯è§æ—¶åˆ·æ–°æ€§èƒ½æ•°æ®
                loadPerformanceMetrics();
            }
        });

        // ===== é¡µé¢å¸è½½æ—¶æ¸…ç†å®šæ—¶å™¨ =====
        window.addEventListener('beforeunload', function() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
        });

        // ===== åˆå§‹åŒ–å®Œæˆæç¤º =====
        console.log('ğŸ–¥ï¸ AIå§¿åŠ¿å‚è€ƒå›¾åº“ - ç³»ç»Ÿç›‘æ§ä¸­å¿ƒå·²å°±ç»ª');
        console.log('ğŸ‘¤ å½“å‰ç”¨æˆ·:', 'marvinli001'); 
        console.log('ğŸ•’ åˆå§‹åŒ–æ—¶é—´:', new Date().toLocaleString('zh-CN'));
        console.log('ğŸ“Š åŠŸèƒ½æ¨¡å—: æ€§èƒ½ç›‘æ§ã€ç³»ç»Ÿç»´æŠ¤ã€é…ç½®ç®¡ç†ã€æ—¥å¿—åˆ†æã€å¤‡ä»½æ¢å¤');
        console.log('âŒ¨ï¸  å¿«æ·é”®: Ctrl+R(åˆ·æ–°) | Ctrl+B(å¤‡ä»½) | Ctrl+L(æ—¥å¿—) | ESC(å–æ¶ˆ)');
        console.log('ğŸ¨ UIä¸»é¢˜: ç°ä»£åŒ–æ¸å˜è®¾è®¡ | å®æ—¶å›¾è¡¨ | æ™ºèƒ½åˆ†æ');
        console.log('âš¡ è‡ªåŠ¨åˆ·æ–°: æ¯30ç§’æ›´æ–°æ€§èƒ½æŒ‡æ ‡');

        // ===== æ€§èƒ½ç›‘æ§ =====
        window.addEventListener('load', function() {
            const loadTime = performance.now();
            console.log(`âš¡ ç³»ç»Ÿç›‘æ§é¡µé¢åŠ è½½å®Œæˆï¼Œè€—æ—¶: ${Math.round(loadTime)}ms`);
            
            // å¦‚æœåŠ è½½æ—¶é—´è¿‡é•¿ï¼Œæ˜¾ç¤ºæç¤º
            if (loadTime > 3000) {
                setTimeout(() => {
                    showInfo('ğŸ“Š ç³»ç»Ÿç›‘æ§é¡µé¢åŠ è½½å®Œæˆï¼å¦‚æœé‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œè¯·å°è¯•åˆ·æ–°é¡µé¢ã€‚');
                }, 1000);
            }
        });

        // ===== é”™è¯¯å¤„ç†å¢å¼º =====
        window.addEventListener('error', function(e) {
            console.error('é¡µé¢é”™è¯¯:', e.error);
            showError('âŒ é¡µé¢å‘ç”Ÿé”™è¯¯ï¼Œè¯·åˆ·æ–°é‡è¯•');
        });

        window.addEventListener('unhandledrejection', function(e) {
            console.error('æœªå¤„ç†çš„Promiseé”™è¯¯:', e.reason);
            showError('âŒ ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¿æ¥åé‡è¯•');
        });
    </script>
</body>
</html>